{% extends 'base.html' %}

{% block content %}
<style>
    .dashboard-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 20px;
    }

    .welcome-message {
        text-align: center;
        margin-bottom: 20px;
    }

    .card {
        width: 100%;
        max-width: 1000px;
        margin-bottom: 20px;
        padding: 20px;
        background-color: #fff;
        border-radius: 10px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    }

    .card h2 {
        margin-top: 0;
    }

    .card ul {
        list-style-type: none;
        padding: 0;
    }

    .card ul li {
        margin: 10px 0;
    }

    .card a {
        text-decoration: none;
        color: #D10A11;
    }

    .card a:hover {
        text-decoration: underline;
    }
    
    .submit-button {
        margin-top: 20px;
        padding: 10px 20px;
        background-color: #D10A11;
        color: #fff;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        text-decoration: none;
    }

    .submit-button:hover {
        background-color: #a00;
    }
</style>

<div class="dashboard-container">
    <div class="welcome-message">
        <h1>Bienvenido al Centro Virtual de Documentación</h1>
        <p>Hola, {{ session['username'] }}. Aquí tienes accesos rápidos a las funcionalidades principales.</p>
    </div>
    <div class="card">
        <h2>Documentos Recientes</h2>
        <ul>
            {% for document in recent_documents %}
            <li><a href="{{ url_for('document.view_file', filename=document.filename) }}">{{ document.filename }}</a></li>
            {% endfor %}
        </ul>
    </div>
    
    
    <div class="card">
        <h2>Documentos Favoritos</h2>
        <ul>
            {% for document in favorite_documents %}
            <li><a href="{{ url_for('document.view_file', filename=document.filename) }}">{{ document.filename }}</a></li>
            {% endfor %}
        </ul>
    </div>

    <div class="card">
        <h2>Documentos Compartidos</h2>
        <ul>
            {% for document in shared_documents %}
            <li><a href="{{ url_for('document.view_file', filename=document.filename) }}">{{ document.filename }}</a> - Compartido por: {{ document.shared_by }}</li>
            {% endfor %}
        </ul>
    </div>
    
    
    
    <div class="card">
        <h2>Notificaciones</h2>
        <ul>
            {% for notification in notifications %}
            <li>{{ notification.message }} - {{ notification.date.strftime('%Y-%m-%d %H:%M:%S') }}</li>
            {% endfor %}
        </ul>
    </div>

    <div class="card">
        <h2>Tareas Pendientes</h2>
        <ul>
            {% for task in user_tasks %}
            <li>{{ task.description }} - Fecha límite: {{ task.due_date.strftime('%Y-%m-%d') }}</li>
            {% endfor %}
        </ul>
        <form method="post" action="{{ url_for('dashboard.add_task') }}" style=" font-family: 'Raleway', sans-serif;">
            <input type="text" name="task_description" placeholder="Nueva tarea" style=" font-family: 'Raleway', sans-serif;">
            <input type="date" name="task_due_date" style=" font-family: 'Raleway', sans-serif;">
            <button type="submit" class="submit-button">Añadir</button>
        </form>
    </div>

    <div class="card">
        <h2>Calendario de Actividades</h2>
        <div id="calendar"></div>
    </div>

    <div class="card">
        <h2>Comentarios y Retroalimentación</h2>
        <form method="post" action="{{ url_for('dashboard.submit_feedback') }}"> 
            <textarea name="feedback" placeholder="Escribe tus comentarios aquí..."  style=" font-family: 'Raleway', sans-serif; width: 100%; height: fit-content;" ></textarea>
            <button type="submit" class="submit-button">Enviar</button>
        </form>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.10.1/main.min.js"></script>
<link href="https://cdn.jsdelivr.net/npm/fullcalendar@5.10.1/main.min.css" rel="stylesheet">
<script>
    document.addEventListener('DOMContentLoaded', function() {
        var calendarEl = document.getElementById('calendar');
        var calendar = new FullCalendar.Calendar(calendarEl, {
            initialView: 'dayGridMonth',
            events: [
                {% for event in user_events %}
                {
                    title: '{{ event.title }}',
                    start: '{{ event.start_date }}',
                    end: '{{ event.end_date }}'
                },
                {% endfor %}
            ]
        });
        calendar.render();
    });
</script>
{% endblock %}
